function main(){function e(){var e={spritesheet:{birdie:["images/bird.png",24,24],clouds:["images/clouds.png",128,64]},image:{finger:["images/pipe.png"],fence:["images/ground.png"]},audio:{flap:["sounds/flap.wav"],score:["sounds/score.wav"],hurt:["sounds/hurt.wav"]}};Object.keys(e).forEach(function(t){Object.keys(e[t]).forEach(function(o){O.load[t].apply(O.load,[o].concat(e[t][o]))})})}function t(){var e=700,t=500;O.world.width=e,O.world.height=t,w=O.add.graphics(0,0),w.beginFill(14544639,1),w.drawRect(0,0,O.world.width,O.world.height),w.endFill(),g=O.add.text(O.world.width/2,10,"",{font:'8px "Press Start 2P"',fill:"#fff",align:"center"}),g.anchor.x=.5,m=O.add.group(),b=O.add.group(),v=O.add.group(),T=O.add.sprite(0,0,"birdie"),T.anchor.setTo(.5,.5),T.animations.add("fly",[0,1,2,3],10,!0),T.inputEnabled=!0,T.body.collideWorldBounds=!0,T.body.gravity.y=GRAVITY,P=O.add.tileSprite(0,O.world.height-32,O.world.width,32,"fence"),P.tileScale.setTo(2,2),x=O.add.text(O.world.width/2,O.world.height/4,"",{font:'16px "Press Start 2P"',fill:"#fff",stroke:"#430",strokeThickness:4,align:"center"}),x.anchor.setTo(.5,.5),E=O.add.text(O.world.width/2,O.world.height-O.world.height/4,"",{font:'8px "Press Start 2P"',fill:"#fff",stroke:"#430",strokeThickness:4,align:"center"}),E.anchor.setTo(.5,.5),A=O.add.text(O.world.width/2,O.world.height/2,"",{font:'16px "Press Start 2P"',fill:"#fff",stroke:"#430",strokeThickness:4,align:"center"}),A.anchor.setTo(.5,.5),A.scale.setTo(2,2),S=O.add.audio("flap"),k=O.add.audio("score"),M=O.add.audio("hurt"),O.input.onDown.add(a),I=new Phaser.Timer(O),I.onEvent.add(r),I.start(),I.add(Math.random()),o()}function o(){u=!1,p=!1,y=0,g.renderable=!0,x.setText("BIRD\nFLAP\n"),E.setText("TOUCH/CLICK TO\nFLAP WINGS"),A.renderable=!1,T.body.allowGravity=!1,T.angle=0,T.reset(O.world.width/4,O.world.height/2),T.scale.setTo(2,2),T.animations.play("fly"),b.removeAll(),v.removeAll()}function n(){g.renderable=!1,T.body.allowGravity=!0,G=new Phaser.Timer(O),G.onEvent.add(l),G.start(),G.add(2),x.setText(y),E.renderable=!1,u=!0}function a(){u||n(),p||(T.body.velocity.y=-FLAP,S.play())}function r(){I.stop();var e=Math.random()*O.height/2,t=m.create(O.width,e,"clouds",Math.floor(4*Math.random())),o=2+2*Math.random();t.alpha=2/o,t.scale.setTo(o,o),t.body.allowGravity=!1,t.body.velocity.x=-SPEED/o,t.anchor.y=0,I.start(),I.add(4*Math.random())}function i(){return OPENING+60*((y>50?50:50-y)/50)}function d(e,t){var o=b.create(O.width,e+(t?-i():i())/2,"finger");return o.body.allowGravity=!1,o.scale.setTo(2,t?-2:2),o.body.offset.y=t?2*-o.body.height:0,o.body.velocity.x=-SPEED,o}function l(){G.stop();var e=(O.height-16-i()/2)/2+(Math.random()>.5?-1:1)*Math.random()*O.height/6,t=(d(e),d(e,!0)),o=v.create(t.x+t.width,0);o.width=2,o.height=O.world.height,o.body.allowGravity=!1,o.body.velocity.x=-SPEED,G.start(),G.add(1/SPAWN_RATE)}function c(e,t){v.remove(t),y+=1,x.setText(y),k.play()}function s(){p=!0,E.setText("TOUCH THE BIRD\nTO TRY AGAIN"),E.renderable=!0,hiscore=hiscore?hiscore:y,hiscore=y>parseInt(hiscore,10)?y:hiscore,A.setText("GAMEOVER\n\nHISCORE\n"+hiscore),A.renderable=!0,b.forEachAlive(function(e){e.body.velocity.x=0}),v.forEach(function(e){e.body.velocity.x=0}),G.stop(),T.events.onInputDown.addOnce(o),M.play()}function h(){if(u){var e=FLAP+T.body.velocity.y;T.angle=90*e/FLAP-180,T.angle<-30&&(T.angle=-30),p||T.angle>90||T.angle<-90?(T.angle=90,T.animations.stop(),T.frame=3):T.animations.play("fly"),p?T.scale.x<4&&T.scale.setTo(1.2*T.scale.x,1.2*T.scale.y):(O.physics.overlap(T,b,s),!p&&T.body.bottom>=O.world.bounds.bottom&&s(),O.physics.overlap(T,v,c)),b.forEachAlive(function(e){e.x+e.width<O.world.bounds.left&&e.kill()}),G.update()}else T.y=O.world.height/2+8*Math.cos(O.time.now/200);(!u||p)&&E.scale.setTo(2+.1*Math.sin(O.time.now/100),2+.1*Math.cos(O.time.now/100)),x.scale.setTo(2+.1*Math.cos(O.time.now/100),2+.1*Math.sin(O.time.now/100)),I.update(),m.forEachAlive(function(e){e.x+e.width<O.world.bounds.left&&e.kill()}),p||(P.tilePosition.x-=O.time.physicsElapsed*SPEED/2)}function f(){}var u,p,y,w,g,m,b,v,T,P,x,E,A,S,k,M,G,I,D={preload:e,create:t,update:h,render:f},N=document.querySelector("#screen"),O=new Phaser.Game(0,0,Phaser.CANVAS,N,D,!1,!1)}function leftClick(e){return window.focus(),e||(e=event),"undefined"==typeof e.which?1==e.button:1==e.which||0==e.button}function nrc(e){return 0==leftClick(e)?ce(e):void 0}function cp(e){e||(e=event),e.stopPropagation?e.stopPropagation():"undefined"!=typeof e.cancelBubble&&(e.cancelBubble=!0)}function ce(e){return e||(e=event),"undefined"!=typeof e.preventDefault?e.preventDefault():"undefined"!=typeof e.cancelBubble&&(e.returnValue=0,e.cancelBubble=!0),!1}"undefined"!=typeof document.oncontextmenu?document.oncontextmenu=ce:document.onclick=nrc,"undefined"!=typeof document.onselectstart&&(document.onselectstart=ce),"undefined"!=typeof document.ondragstart&&(document.ondragstart=ce);var SPEED=690,GRAVITY=40,FLAP=620,SPAWN_RATE=1/1.2,OPENING=134,hiscore=0;WebFontConfig={google:{families:["Press+Start+2P::latin"]},active:main},function(){var e=document.createElement("script");e.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",e.type="text/javascript",e.async="true";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();